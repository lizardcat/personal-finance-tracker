{% extends "base.html" %}

{% block title %}Settings - Personal Finance Tracker{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-cog me-2"></i>Settings</h2>
</div>

<div class="row">
    <!-- User Profile -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0"><i class="fas fa-user me-2"></i>User Profile</h5>
            </div>
            <div class="card-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" value="{{ user.username }}" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" value="{{ user.email }}">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Default Currency</label>
                        <select class="form-select">
                            <option value="USD" {% if user.default_currency == 'USD' %}selected{% endif %}>USD - US Dollar</option>
                            <option value="KES" {% if user.default_currency == 'KES' %}selected{% endif %}>KES - Kenyan Shilling</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Monthly Income</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" value="{{ user.monthly_income or 0 }}" step="0.01">
                        </div>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="updateProfile()">
                        Update Profile
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Budget Categories Management -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0"><i class="fas fa-tags me-2"></i>Budget Categories</h5>
                <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                    <i class="fas fa-plus me-1"></i>Add Category
                </button>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">Income Categories</h6>
                            <small class="text-muted">Sources of income</small>
                        </div>
                        <span class="badge bg-success rounded-pill">3</span>
                    </div>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">Expense Categories</h6>
                            <small class="text-muted">Where money is spent</small>
                        </div>
                        <span class="badge bg-danger rounded-pill">8</span>
                    </div>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div>
                            <h6 class="mb-1">Savings Categories</h6>
                            <small class="text-muted">Financial goals</small>
                        </div>
                        <span class="badge bg-primary rounded-pill">2</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Management -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0"><i class="fas fa-database me-2"></i>Data Management</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-primary" onclick="exportData()">
                        <i class="fas fa-download me-2"></i>Export All Data
                    </button>
                    <button class="btn btn-outline-info" onclick="backupData()">
                        <i class="fas fa-save me-2"></i>Create Backup
                    </button>
                    <button class="btn btn-outline-warning" onclick="importData()">
                        <i class="fas fa-upload me-2"></i>Import Data
                    </button>
                    <hr>
                    <button class="btn btn-outline-danger" onclick="clearData()">
                        <i class="fas fa-trash me-2"></i>Clear All Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Security -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0"><i class="fas fa-shield-alt me-2"></i>Account Security</h5>
            </div>
            <div class="card-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Current Password</label>
                        <input type="password" class="form-control" placeholder="Enter current password">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">New Password</label>
                        <input type="password" class="form-control" placeholder="Enter new password">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Confirm New Password</label>
                        <input type="password" class="form-control" placeholder="Confirm new password">
                    </div>
                    <button type="button" class="btn btn-warning" onclick="changePassword()">
                        Change Password
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Application Info -->
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0"><i class="fas fa-info-circle me-2"></i>Application Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Account Created:</strong> {{ user.created_at.strftime('%B %d, %Y') }}</p>
                        <p><strong>Total Categories:</strong> {{ user.budget_categories|length }}</p>
                        <p><strong>Total Transactions:</strong> {{ user.transactions|length }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Version:</strong> 1.0.0</p>
                        <p><strong>Last Login:</strong> Today</p>
                        <p><strong>Data Storage:</strong> Local Database</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Category Modal -->
<div class="modal fade" id="addCategoryModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Budget Category</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="categoryForm">
                    <div class="mb-3">
                        <label class="form-label">Category Name</label>
                        <input type="text" class="form-control" name="name" placeholder="e.g., Groceries" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Category Type</label>
                        <select class="form-select" name="category_type" required>
                            <option value="expense">Expense</option>
                            <option value="income">Income</option>
                            <option value="saving">Savings Goal</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Allocated Amount</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" class="form-control" name="allocated_amount" step="0.01" min="0" placeholder="0.00" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Color</label>
                        <input type="color" class="form-control form-control-color" name="color" value="#007bff">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="submitCategory()">Add Category</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
function updateProfile() {
    alert('Profile update functionality coming soon!');
}

function changePassword() {
    alert('Password change functionality coming soon!');
}

function exportData() {
    alert('Data export functionality coming soon!');
}

function backupData() {
    alert('Backup functionality coming soon!');
}

function importData() {
    alert('Import functionality coming soon!');
}

function clearData() {
    if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
        alert('Clear data functionality coming soon!');
    }
}

function submitCategory() {
    alert('Add category functionality coming soon!');
    // For now, just close the modal
    document.querySelector('#addCategoryModal .btn-close').click();
}
</script>
{% endblock %}